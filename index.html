<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phone & Zombie Apocalypse Game</title>
  <style>
    body { margin: 0; background-color: #111; color: white; }
    canvas { display: block; margin: auto; background: #222; }
    h1 { text-align: center; font-family: Arial, sans-serif; }
    #gameMessage { text-align: center; }
  </style>
</head>
<body>
  <h1>ðŸ“± Phone & Zombie Apocalypse Game</h1>
  <canvas id="gameCanvas" width="800" height="500"></canvas>
  <p id="gameMessage"></p>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let gameStage = 0; // Game stages: 0 - Phone Game, 1 - Zombie Game

    // Phone Game Variables
    let phoneNumbersPressed = 0;
    let level = 1;
    let targetNumber;
    let gameRunning = true;

    // Zombie Game Variables
    const player = {
      x: 100,
      y: canvas.height / 2,
      width: 30,
      height: 30,
      speed: 5,
      health: 100,
      bullets: [],
      gunAngle: 0,
      gunLength: 30,
    };

    let zombies = [];
    let zombieCount = 0;
    let zombieSpawnRate = 1000;
    let zombieHealthIncreaseInterval = 10000;

    // Phone Game Logic
    function startPhoneGame() {
      document.getElementById("gameMessage").textContent = "Phone Game: Don't press the number it says!";
      phoneNumbersPressed = 0;
      targetNumber = Math.floor(Math.random() * 10);
      phoneGameLoop();
    }

    function phoneGameLoop() {
      if (phoneNumbersPressed >= 15) {
        document.getElementById("gameMessage").textContent = "You won the phone game! Get ready for the next part.";
        setTimeout(startZombieGame, 2000);
        return;
      }

      targetNumber = Math.floor(Math.random() * 10);
      document.getElementById("gameMessage").textContent = `Press ${targetNumber}... (Level ${level})`;

      canvas.addEventListener("click", (e) => {
        if (gameRunning && !e.target.contains(e)) {
          if (targetNumber === e.clientX % 10) { // Simple check if clicked on right number area
            phoneNumbersPressed++;
          } else {
            document.getElementById("gameMessage").textContent = "Wrong number! Game over!";
            gameRunning = false;
            setTimeout(startPhoneGame, 2000);
          }
        }
      });
    }

    // Zombie Game Logic
    function startZombieGame() {
      gameStage = 1;
      document.getElementById("gameMessage").textContent = "Zombie Apocalypse Shooter: Survive!";
      setInterval(spawnZombie, zombieSpawnRate);
      setInterval(increaseZombieHealth, zombieHealthIncreaseInterval);
      gameLoop();
    }

    // Player shooting logic
    function shootBullet() {
      const angle = player.gunAngle;
      const speed = 10;
      const bullet = {
        x: player.x + Math.cos(angle) * player.gunLength,
        y: player.y + Math.sin(angle) * player.gunLength,
        dx: Math.cos(angle) * speed,
        dy: Math.sin(angle) * speed,
      };
      player.bullets.push(bullet);
    }

    // Player movement controls
    function movePlayer() {
      if (keys["ArrowUp"] && player.y > 0) player.y -= player.speed;
      if (keys["ArrowDown"] && player.y < canvas.height - player.height) player.y += player.speed;
      if (keys["ArrowLeft"] && player.x > 0) player.x -= player.speed;
      if (keys["ArrowRight"] && player.x < canvas.width - player.width) player.x += player.speed;
    }

    // Move zombies and check if they collide with player
    function updateZombies() {
      zombies.forEach(z => {
        const dx = player.x - z.x;
        const dy = player.y - z.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const speed = 1;

        if (dist > 10) {
          z.x += dx / dist * speed;
          z.y += dy / dist * speed;
        } else {
          player.health -= 1;
        }

        player.bullets.forEach((bullet, i) => {
          const bulletDist = Math.sqrt(Math.pow(bullet.x - z.x, 2) + Math.pow(bullet.y - z.y, 2));
          if (bulletDist < z.size) {
            z.health -= 1;
            player.bullets.splice(i, 1);
          }
        });

        if (z.health <= 0) {
          zombies.splice(zombies.indexOf(z), 1);
          zombieCount += 1;
        }
      });
    }

    // Draw everything to canvas
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw player
      ctx.fillStyle = "white";
      ctx.fillRect(player.x - player.width / 2, player.y - player.height / 2, player.width, player.height);

      // Draw gun
      ctx.strokeStyle = "white";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(player.x, player.y);
      ctx.lineTo(player.x + Math.cos(player.gunAngle) * player.gunLength, player.y + Math.sin(player.gunAngle) * player.gunLength);
      ctx.stroke();

      // Draw bullets
      ctx.fillStyle = "yellow";
      player.bullets.forEach(b => {
        ctx.beginPath();
        ctx.arc(b.x, b.y, 5, 0, Math.PI * 2);
        ctx.fill();
      });

      // Draw zombies
      ctx.fillStyle = "green";
      zombies.forEach(z => {
        ctx.beginPath();
        ctx.arc(z.x, z.y, z.size, 0, Math.PI * 2);
        ctx.fill();
      });

      // Check if player is dead
      if (player.health <= 0) {
        gameRunning = false;
        document.getElementById("gameMessage").textContent = "You were overrun by zombies! Game Over!";
      }
    }

    // Game loop
    function gameLoop() {
      if (gameRunning) {
        movePlayer();
        updateZombies();
        draw();
        requestAnimationFrame(gameLoop);
      }
    }

    // Spawn a new zombie at random position
    function spawnZombie() {
      const edge = Math.floor(Math.random() * 4);
      let x = edge === 0 ? canvas.width : edge === 1 ? 0 : Math.random() * canvas.width;
      let y = edge === 2 ? 0 : edge === 3 ? canvas.height : Math.random() * canvas.height;
      zombies.push({ x, y, size: 20, health: 3 });
    }

    // Increase zombie health
    function increaseZombieHealth() {
      zombies.forEach(z => {
        if (z.health < 10) z.health += 1;
      });
    }

    // Handle keypresses
    let keys = {};
    document.addEventListener("keydown", (e) => keys[e.key] = true);
    document.addEventListener("keyup", (e) => keys[e.key] = false);
    document.addEventListener("keydown", (e) => {
      if (e.key === " " && gameRunning) shootBullet();
    });

    // Start the game (Phone Game first)
    startPhoneGame();

  </script>
</body>
</html>
